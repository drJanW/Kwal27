PLAN B1: Brightness Workflow Without Lux Sensor
================================================
Status: ANALYSIS
Date: 2026-01-02

PROBLEM
-------
Current code unconditionally calls setBrightnessShiftedHi() in cb_luxMeasureRead(),
even when there is no lux sensor. This overwrites the boot default with garbage
calculated from uninitialized/zero lux values.

BASE CASE: NO LUX SENSOR
------------------------
1. LightBoot sets brightnessShiftedHi = 100 (conservative default, ~40% of max)
2. Web GUI shows slider with ~40% upper limit
3. User adjusts brightness within 0-40% range
4. Shifts can modify: UP to ~250 (2.5x) or DOWN toward 0
5. brightnessShiftedHi is NEVER touched after boot (except by shifts)
6. Done. Clean.

NOTE: Boot default intentionally NOT max! Leaves headroom for shift UP.

ENHANCED CASE: WITH LUX SENSOR
------------------------------
1. Same boot default (100 = conservative)
2. Lux measurement timer fires periodically
3. IF sensor is ready AND delivers valid reading THEN:
   - Compute new Hi based on ambient lux (can go UP to max in bright room)
   - setBrightnessShiftedHi(computed)
4. ELSE: Do nothing. Boot default (100) remains intact.

Lux sensor ENABLES higher brightness in bright environments.
Without sensor, you stay at safe 40%.

CURRENT BROKEN FLOW
-------------------
cb_luxMeasureRead():
  SensorManager::performLuxMeasurement();
  float lux = SensorManager::ambientLux();     // returns garbage if no sensor
  uint8_t base = computeLuxBrightness(lux);    // computes wrong value
  setBrightnessShiftedHi(base);                // OVERWRITES boot default!

PROPOSED FIX
------------
cb_luxMeasureRead():
  if (!SensorManager::isLuxSensorReady()) {
      // No sensor = no action = boot default preserved
      lightManager.setMeasurementEnabled(false);
      return;
  }
  // ... rest of existing code only runs with valid sensor

FILES TO CHANGE
---------------
1. LightRun.cpp - Add early return in cb_luxMeasureRead()
2. SensorManager.cpp - Revert ambientLuxVal init to 0.0f (sentinel not needed)
3. LightPolicy.cpp - Remove sentinel check (not needed)
4. WebGuiStatus.cpp - Remove sentinel check (not needed)

PRINCIPLE
---------
The ABSENCE of a sensor = boot default stays intact.
Only VALID sensor data may modify brightnessShiftedHi.
No sentinels. No special values. Just: don't act without valid data.
